clear all
close all
c1=sym('c1');
c3=sym('c3');
r1=sym('r1');
r2=sym('r2');
r3=sym('r3');
r4=sym('r4');
dr=sym('dr');
s=sym('s');
f=sym('f');
h=(4*(16*pi^4*c1^3*c3^2*f^4*r1^3*r3^2*r4-4*pi^2*c1^3*f^2*r1^3*r4+4*pi^2*c1^3*f^2*r1^2*r2*r3-4*pi^2*c1^3*f^2*r1^2*r3*r4+4*pi^2*c1^3*f^2*r1*r2*r3^2-8*pi^2*c1^2*c3*f^2*r1^2*r3*r4+4*pi^2*c1*c3^2*f^2*r1*r3^2*r4-c1*r1*r4+c1*r2*r3-c1*r3*r4-2*c3*r3*r4))*c1*f^2*pi^2/(sqrt((16*pi^4*c1^2*c3^2*f^4*r1^2*r3^2*r4^2+4*pi^2*c1^2*f^2*r1^2*r4^2-8*pi^2*c1^2*f^2*r1*r2*r3*r4+4*pi^2*c1^2*f^2*r2^2*r3^2-8*pi^2*c1*c3*f^2*r2*r3^2*r4+4*pi^2*c3^2*f^2*r3^2*r4^2+r4^2)/((16*pi^4*c1^2*c3^2*f^4*r1^2*r3^2+4*pi^2*c1^2*f^2*r1^2+8*pi^2*c1^2*f^2*r1*r3+4*pi^2*c1^2*f^2*r3^2+8*pi^2*c1*c3*f^2*r3^2+4*pi^2*c3^2*f^2*r3^2+1)*(r2+r4)^2))*(16*pi^4*c1^2*c3^2*f^4*r1^2*r3^2+4*pi^2*c1^2*f^2*r1^2+8*pi^2*c1^2*f^2*r1*r3+4*pi^2*c1^2*f^2*r3^2+8*pi^2*c1*c3*f^2*r3^2+4*pi^2*c3^2*f^2*r3^2+1)^2*(r2+r4));
%h=(1/2)*(16*pi^4*c1^2*c3^2*f^4*r1^2*r2*r3^2*r4^2+16*pi^4*c1^2*c3^2*f^4*r1*r2^3*r3^2*r4-4*pi^2*c1^2*f^2*r1^2*r2*r4^2-4*pi^2*c1^2*f^2*r1^2*r3*r4^2-4*pi^2*c1^2*f^2*r1*r2^3*r4+4*pi^2*c1^2*f^2*r1*r2*r3^2*r4+4*pi^2*c1^2*f^2*r2^4*r3+4*pi^2*c1^2*f^2*r2^3*r3^2-8*pi^2*c1*c3*f^2*r2^3*r3*r4-8*pi^2*c1*c3*f^2*r2^2*r3^2*r4+4*pi^2*c3^2*f^2*r2*r3^2*r4^2-r2*r4^2-r3*r4^2)/(sqrt((16*pi^4*c1^2*c3^2*f^4*r1^2*r3^2*r4^2+4*pi^2*c1^2*f^2*r1^2*r4^2-8*pi^2*c1^2*f^2*r1*r2*r3*r4+4*pi^2*c1^2*f^2*r2^2*r3^2-8*pi^2*c1*c3*f^2*r2*r3^2*r4+4*pi^2*c3^2*f^2*r3^2*r4^2+r4^2)/((r2+r4)^2*pi^2*f^2*c1^2*(4*pi^2*c3^2*f^2*r2^2*r3^2+r2^2+2*r2*r3+r3^2)))*(r2+r4)^2*pi^2*f^2*c1^2*(4*pi^2*c3^2*f^2*r2^2*r3^2+r2^2+2*r2*r3+r3^2)^2);
%h=(4*(16*pi^4*c1^3*c3^2*f^4*r1^3*r3^2*r4-4*pi^2*c1^3*f^2*r1^3*r4+4*pi^2*c1^3*f^2*r1^2*r2*r3-4*pi^2*c1^3*f^2*r1^2*r3*r4+4*pi^2*c1^3*f^2*r1*r2*r3^2-8*pi^2*c1^2*c3*f^2*r1^2*r3*r4+4*pi^2*c1*c3^2*f^2*r1*r3^2*r4-c1*r1*r4+c1*r2*r3-c1*r3*r4-2*c3*r3*r4))*c1*f^2*pi^2/(sqrt((16*pi^4*c1^2*c3^2*f^4*r1^2*r3^2*r4^2+4*pi^2*c1^2*f^2*r1^2*r4^2-8*pi^2*c1^2*f^2*r1*r2*r3*r4+4*pi^2*c1^2*f^2*r2^2*r3^2-8*pi^2*c1*c3*f^2*r2*r3^2*r4+4*pi^2*c3^2*f^2*r3^2*r4^2+r4^2)/((16*pi^4*c1^2*c3^2*f^4*r1^2*r3^2+4*pi^2*c1^2*f^2*r1^2+8*pi^2*c1^2*f^2*r1*r3+4*pi^2*c1^2*f^2*r3^2+8*pi^2*c1*c3*f^2*r3^2+4*pi^2*c3^2*f^2*r3^2+1)*(r2+r4)^2))*(16*pi^4*c1^2*c3^2*f^4*r1^2*r3^2+4*pi^2*c1^2*f^2*r1^2+8*pi^2*c1^2*f^2*r1*r3+4*pi^2*c1^2*f^2*r3^2+8*pi^2*c1*c3*f^2*r3^2+4*pi^2*c3^2*f^2*r3^2+1)^2*(r2+r4));
%r1
h=4*r3*pi^2*f^2*c1^2*(16*pi^4*c1^2*c3^2*f^4*r1^2*r3^2*r4-16*pi^4*c1^2*c3^2*f^4*r1*r2*r3^3+16*pi^4*c1^2*c3^2*f^4*r1*r3^3*r4+32*pi^4*c1*c3^3*f^4*r1*r3^3*r4+4*pi^2*c1^2*f^2*r1^2*r4-4*pi^2*c1^2*f^2*r1*r2*r3+4*pi^2*c1^2*f^2*r1*r3*r4-4*pi^2*c1^2*f^2*r2*r3^2+8*pi^2*c1*c3*f^2*r1*r3*r4-4*pi^2*c3^2*f^2*r3^2*r4-r4)/(sqrt((16*pi^4*c1^2*c3^2*f^4*r1^2*r3^2*r4^2+4*pi^2*c1^2*f^2*r1^2*r4^2-8*pi^2*c1^2*f^2*r1*r2*r3*r4+4*pi^2*c1^2*f^2*r2^2*r3^2-8*pi^2*c1*c3*f^2*r2*r3^2*r4+4*pi^2*c3^2*f^2*r3^2*r4^2+r4^2)/((r4+r2)^2*(16*pi^4*c1^2*c3^2*f^4*r1^2*r3^2+4*pi^2*c1^2*f^2*r1^2+8*pi^2*c1^2*f^2*r1*r3+4*pi^2*c1^2*f^2*r3^2+8*pi^2*c1*c3*f^2*r3^2+4*pi^2*c3^2*f^2*r3^2+1)))*(r4+r2)*(16*pi^4*c1^2*c3^2*f^4*r1^2*r3^2+4*pi^2*c1^2*f^2*r1^2+8*pi^2*c1^2*f^2*r1*r3+4*pi^2*c1^2*f^2*r3^2+8*pi^2*c1*c3*f^2*r3^2+4*pi^2*c3^2*f^2*r3^2+1)^2);
r2=20e3;
r4=10e3;
c1=820e-12;
c3=820e-12;

deltar=250; 

r3=1/(2*pi*(f) * c1);
r1=r3 + deltar;
%r3=r1 - deltar;
%f=1/(2*pi*sqrt(r1*r3) * c1);
vd=subs(h)*(deltar/r3);
%vd=subs(h)*(deltar/r1);
%var=[1941:10:19409];
%data=double(subs(vd, r1, var));

var=[10e3:50:100e3];
data=double(subs(vd, f, var));

plot(var,data);







